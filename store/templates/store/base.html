{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Amazon</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
    <header style="background-color: #131921; padding: 10px 20px; display: flex; align-items: center; color: white; gap: 20px; position: sticky; top: 0; z-index: 1000;">

        <a href="{% url 'home' %}" style="color: white; text-decoration: none; font-size: 1.4em;">
            <strong>My Amazon</strong>
        </a>

        <form action="{% url 'home' %}" method="GET" style="flex-grow: 1; display: flex; margin: 0;">
            <input type="text" name="search" placeholder="Search My Amazon..."
                   value="{{ request.GET.search|default:'' }}"
                   style="flex-grow: 1; padding: 10px; border-radius: 4px 0 0 4px; border: none; outline: none;">
            <button type="submit" style="background: #febd69; border: none; padding: 0 15px; border-radius: 0 4px 4px 0; cursor: pointer; transition: 0.2s;">ğŸ”</button>
        </form>

        <div style="display: flex; align-items: center; gap: 20px; font-size: 14px;">

            {% if user.is_authenticated %}
                <div style="line-height: 1.2;">
                    <span style="display: block; font-size: 11px; color: #ccc;">Hello, {{ user.username }}</span>
                    <a href="{% url 'order_history' %}" style="color: white; text-decoration: none;"><strong>Account & Orders</strong></a>
                </div>

                <div class="cart-wrapper" style="position: relative;">
                    <a href="{% url 'cart' %}" style="color: white; text-decoration: none; font-size: 16px; display: flex; align-items: center; gap: 5px;">
                        <span style="font-size: 20px;">ğŸ›’</span>
                        <strong>Cart ({{ cart_count }})</strong>
                    </a>

                    <div class="cart-hover-box">
                        <h4 style="color: #111; margin: 0 0 10px 0; font-size: 15px;">Cart Summary</h4>
                        <div id="cart-items-preview">
                             <p style="color: #555; font-size: 13px; margin-bottom: 10px;">
                                 You have <strong>{{ cart_count }}</strong> item(s) in your basket.
                             </p>
                        </div>
                        <hr style="border: 0; border-top: 1px solid #eee; margin: 10px 0;">
                        <a href="{% url 'cart' %}" class="btn-amazon btn-yellow" style="display:block; text-align:center; text-decoration: none; padding: 8px; border-radius: 5px; font-size: 12px; font-weight: bold; color: #111;">
                            View Cart & Checkout
                        </a>
                    </div>
                </div>

                <form action="{% url 'logout' %}" method="POST" style="margin: 0; display: inline;">
                    {% csrf_token %}
                    <button type="submit" style="background: none; border: none; color: #f08804; text-decoration: none; font-weight: bold; font-family: inherit; font-size: inherit; cursor: pointer; padding: 0;">
                        Logout
                    </button>
                </form>

            {% else %}
                <a href="{% url 'login' %}" style="color: white; text-decoration: none;">Sign In</a>
                <a href="{% url 'register' %}" style="background: #febd69; color: black; padding: 8px 15px; border-radius: 4px; text-decoration: none; font-weight: bold;">Register</a>
            {% endif %}
        </div>
    </header>

    {% if messages %}
        <div class="messages-container" style="padding: 10px 20px;">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}" style="padding: 10px; margin-bottom: 10px; border-radius: 4px; background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb;">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <main>
        {% block content %}{% endblock %}
    </main>

    <button id="backToTop" title="Go to top">â†‘ Back to Top</button>

    <script src="{% static 'js/main.js' %}"></script>
</body>
</html>